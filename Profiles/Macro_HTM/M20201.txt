
RunMacro(AS3.Getbuttonstate(20201));

#Events

static bool isMacroRunning = false; // Variabila globală pentru a verifica starea macro-ului

// Metoda principală care rulează macro-ul
public void RunMacro(bool status) {
    if (!isMacroRunning) {
        isMacroRunning = true; // Setăm starea că macro-ul este în execuție
		
		if (!status)
		{
		   DialogResult result = MessageBox.Show("Are you sure you want to change the rack axis?", "Changing rack axis", MessageBoxButtons.YesNo, MessageBoxIcon.Question, MessageBoxDefaultButton.Button2, MessageBoxOptions.ServiceNotification);
		   //exec.AddStatusmessage( "Raspuns = " + result );

			if (result == DialogResult.Yes) {
				AS3.Switchbutton(true, 20201);
				//exec.Writekey("atcSetup", "rackAxis", "Y");
				AS3.Switchbutton(false, 20200);
				
				AS3.Setfieldtext("Y", 30000); // step on Y axis
				AS3.Validatefield(30000); 
				exec.Writekey("UserTextfields", "30000", "Y");
				
				AS3.Setfieldtext("X", 30001); // clearance on X axis
				AS3.Validatefield(30001); 
				exec.Writekey("UserTextfields", "30001", "X"); 
				}
		}

        // Resetăm starea macro-ului
        isMacroRunning = false; 
    } else {
        return;
    }
}